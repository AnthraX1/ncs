<html>
<head>
<meta http-equiv="Content-Language" content="zh-cn">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<META HTTP-EQUIV="Expires" CONTENT="0">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Jon Eyrick" CONTENT="no-cache">
<title>main</title>
<script>
var dfd1="0"
function gotoPage(pagenum)

{
		form1.FunName.value='ncsWebIpLog';
    form1.CurPg.value = pagenum;
}

function goto(t){
 tt=showModalDialog(t, window, 'status:no;center:yes;help:no;minimize:no;maximize:yew;border:thick;statusbar:no;dialogWidth:520px;scroll:yes;dialogHeight:530px');
}

function lprint()
{
form1.cx.style.display="none";
form1.rycx.style.display="none";
form1.hsear.style.display="none";
form1.pr.style.display="none";
form1.exp.style.display="none";
window.print();

form1.cx.style.display="";
form1.rycx.style.display="";
form1.hsear.style.display="";
form1.pr.style.display="";
form1.exp.style.display="";
}
function showuser(did,uid)
{
var temp_var="/pronline/Msg?FunName@ncsWebShowUserinfo&did@"+did+"+uid@"+uid;
	showModalDialog(temp_var, window, 'status:no;center:yes;help:no;minimize:no;maximize:yew;border:thick;statusbar:no;dialogWidth:520px;scroll:yes;dialogHeight:640px');
}
function passdate()
{
parent.form1.CurPg.value='[#CurPg#]';
	
//parent.form1.TotPg.value='[#TotPg#]';
//parent.form1.TotRec.value='[#TotRec#]';

parent.document.all.wlj.innerHTML='<b style="font-size: 10pt;color:#00237e;">IP连接日志([#title_name#])</b>';
//	parent.form1.did.value=form1.userid.value;
//	parent.form1.uid.value=form1.uid.value;
//	parent.form1.sdate.value=form1.sdate.value;
//	parent.form1.edate.value=form1.edate.value;

parent.document.all.page.innerHTML='[#page#]&nbsp;&nbsp;';
}



function changservice(){

callServer();
//document.all.service.options[0].value='1';
//document.all.service.options[0].text="111";


}
	var xmlHttp = false;

//调用AJAX
 function callServer() 
 { 
 
  if( xmlHttp && xmlHttp .readyState != 0 )
   {
    xmlHttp.abort();
   }
   
   xmlHttp = createXMLHttpRequest();
 
   if( xmlHttp )
   {
   var web_url='/pronline/Msg?FunName@ncWebShowServiceDet&groupid@'+form1.serviceclass.value+'&xx@'+Math.random()*999;
    //打开连接
    xmlHttp.open("GET",web_url, true);
    //设置回调函数
    xmlHttp.onreadystatechange = updatePage;

    xmlHttp.send(null);
  
  }

 }
	
		 //ajax回调处理函数
 function updatePage() 
 {
  
   if (xmlHttp.readyState == 4) 
   {
    var response = xmlHttp.responseText;
//alert(response);         
//    document.getElementById("result").innerHTML = response;
var temp_id=getxmlbyname(response,"<sid>","</sid>");
var temp_name=getxmlbyname(response,"<sname>","</sname>");
var aid=new Array();
var aname=new Array();
aid=temp_id.split("|");
aname=temp_name.split("|");
var i;
document.all.service.length=aid.length;
for(i=0;i<aid.length;i++){
	document.all.service.options[i].value=aid[i];
 document.all.service.options[i].text=aname[i];
	}

   }
 
 }


function cleara(){
  form1.sdate.value='';
  form1.edate.value='';
  form1.mac.value='';
  form1.port.value='';
  form1.username.value='';
  form1.idcard.value='';
  form1.sip.value='';
  form1.trantype.value='';
  form1.dip.value='';
  form1.serviceclass.value='';
  form1.service.value='';
  form1.servicecode.value='';
  form1.userid.value='';
  form1.groupid.value='';
}






// -->
<!-- Hide
var ll=[#CurPg#]
var yy=[#TotPg#]
function killErrors() {
return true;
}
window.onerror = killErrors;
// -->

</script>

<script src="/js/drawtable.js"></script>
<script src="/js/ajax.js"></script>
<script src="/js/calendar.js"></script>
<SCRIPT language=JavaScript>
<!--

var recordID = null;
var Table = new FlexibleTable ('DataTable', '100%', '420', 'center', 32, 'flexibleTableSpan');

Table.Header ('<input type="button" name="b1" value="全选"  class="anniu_1"  onClick="allChecked()">', '单位名称', '用户名', '开始时间','源IP地址','目标IP地址','端口','协议','服务','上行流量','下行流量');
Table.ColumnsWidth ('40', '102', '100', '110', '90', '90', '50','40','70','72','72');
Table.HeaderAligment ('center', 'center', 'center', 'center', 'center', 'center', 'center','center', 'center', 'center','center');
Table.BodyAligment ('center', 'left', 'left', 'left', 'left', 'left','right','center', 'center', 'right','right');

Table.SetRowsTemplate (" onMouseOver=\"javascript:mouseovertr2(this);\" onMouseOut=\"javascript:mouseouttr2(this);\" onClick=\"setSelect(this);\"  ");
[#SLPB#]
Table.Row('<input type="checkbox" name="ch[#num#]" value="[#sid#]"><input type="hidden" name="ccod[#num#]" value="[#ccode#]"><input type="hidden" name="userid[#num#]" value="[#userid#]">','&nbsp;[#cname#]','<a href="#xxm" onclick=showuser("[#did#]","[#uid#]")>&nbsp;[#udisp#]</a>','&nbsp;[#sdate#]','&nbsp;[#sip#]','&nbsp;[#dip#]','[#port#]&nbsp;','&nbsp;[#trantype#]','&nbsp;[#service#]','[#ubytes#]&nbsp;','[#dbytes#]&nbsp;');
[#SLPE#]

//-->
</SCRIPT>


<style type="text/css">
<!--
.ttt {  border-style: outset; border-top-width: 2px; border-right-width: 2px; border-bottom-width: 2px; border-left-width: 2px}
.nnoo {  filter: Gray}
-->

</style>
<link rel="stylesheet" href="/css/css.css" type="text/css">
</head>

<BODY  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" bgcolor="#DEE8FA" leftMargin=2 topMargin=2 scroll=no onload=Table.Draw();passdate();>
	<form name="form1" method="post" action="/pronline/Msg">
			<input type="hidden" name="userid" value="ncsFormonSearch_ib">

	<input type="hidden" name="plate" value="ncsmsg_showinfo.htm">
	  <input type="hidden" name="export1" value="">
  <input type="hidden" name="FunName" value="ncsWebReplace">
  <input type="hidden" name="fun" value="ncsIpSearch_ib">
  <input type="hidden" name="CurPg"      value="[#CurPg#]">
  <input type="hidden" name="TotPg"      value="[#TotPg#]">
  <input type="hidden" name="lcount"      value="[#TotRec#]">

  <input type="hidden" name="uid" value="[#uid#]">
  <input type="hidden" name="did" value="[#userid#]">
  <input type="hidden" name="groupid" value="[#groupid#]">
  <input type="hidden" name="zd_flag" value="[#zd_flag#]">

<!--  <input type="hidden" name="service" value="[#service#]">
-->

  <input type="hidden" name="sorta" value="[#sorta#]">
  <input type="hidden" name="ordera" value="[#ordera#]">

  <input type="hidden" name="cond" value="">

<!--		 <input type="hidden" name="servicecode" value="[#servicecode#]">
-->
		 <input type="hidden" name="compname" value="[#compname#]">
		<TABLE  height="100%" cellSpacing=0 cellPadding=0 width="100%" border=0>
  	<TR>
    		<TD valign="top" colspan="2"><SPAN id=flexibleTableSpan></SPAN></TD>
  	</TR>
  	
  	
  	
  	
  	
  	
  	
  	
  	
  	  	      <tr height="110">
       	        	<td  class="bordnr" valign="top">
       	        		<table border=0 cellpadding=0 cellspacing=0 width="100%">
       	             <tr height="40">
          	  	     	<td  align="center">&nbsp;上网时间</td>
          	  	     	<td><input type="text" name="sdate" value="[#sdate#]" size="12" maxlength="10"> <input type="button" name="sdate_but" style="position:relative;left:-21px;top:-2px;width:15px;height:17px" value='…' onclick="fPopCalendar(sdate,sdate,'Up');return false">&nbsp;</td> 
          	  	     	<td  align="center">&nbsp;到</td>
          	  	     	<td ><input type="text" name="edate" value="[#edate#]" size="12" maxlength="10"> <input type="button" name="edate_but" style="position:relative;left:-21px;top:-2px;width:15px;height:17px" value='…' onclick="fPopCalendar(edate,edate,'Up');return false">&nbsp;</td> 
          	  	     	<td  align="center">&nbsp;MAC地址</td>
          	  	     	<td ><input type="text" name="mac" value="[#mac#]" size="18"></td>
          	  	     	<td>&nbsp;端口</td>
          	  	     	<td><input type="text" name="port" value="[#dport#]" size="5" maxlength="5"></td>
          	  	     	<td align="center"><input name="cxx" type="submit"  value="查 询" onclick="form1.CurPg.value='1'"></td> 	  	     	
          	  	    </tr>
          	  	     <tr height="30">
          	  	     	<td width="90" align="center">&nbsp;用户名</td>
          	  	     	<td width="180">
                      <input type="text" name="username" value="[#username#]" size="20" >

          	  	     		</td>  
          	  	     	<td width="80" align="center">&nbsp;证件号</td>
          	  	     	<td width="180"><input type="text" name="idcard" value="[#idcard#]" size="19"></td>
          	  	     	<td width="80" align="center">&nbsp;源IP</td>
          	  	     	<td ><input type="text" name="sip" value="[#sip#]" size="18"></td>
          	  	     	<td width="50">&nbsp;协议</td>
          	  	     	<td><select name="trantype">
                      <option value="" selected>全部</option>
                      <option value="17">UDP</option>
                      <option value="6">TCP</option>
                    </select></td>  
          	  	     	<td width="120" align="center"><input name="clearaq" type="button"  value="清除条件" onclick="cleara()"></td>	     	
          	  	    </tr>
          	  	     <tr height="30">
          	  	     	<td width="90" align="center">&nbsp;目标IP</td>
          	  	     	<td width="160"><input type="text" name="dip" value="[#dip#]" size="22" ></td> 
          	  	     	
          	  	     	<td > 服务大类</td>
          	  	     	<td colspan="2"><select name="serviceclass" style="width:80" onchange="changservice()">
          	  	     	<option value="" selected>全部</option>
          	  	     	[#SLPB#]
                      <option value="[#cgid#]">[#cgname#]</option>
                      [#SLPE#]
                      
                    </select>&nbsp;细分服务
          	  	     	<select name="service" style="width:90">
          	  	     	<option value=" " selected>全部</option>
          	  	     	[#SLPB#]
                      <option value="[#id_s#]">[#name_s#]</option>
                      [#SLPE#]
                      
                    </select></td>
          	  	     	<td colspan="4">&nbsp;单位名称或代码
                    <input type="text" name="servicecode" size="20" maxlength="32" value="[#servicecode#]" > 
                   </td>
 
          	  	        	
          	  	    </tr>

          	  	   </table>
       	        	</td>
       	        </tr> 
  	
  	
  	
  	
  	
  	
  	
  	
 	</TABLE>
 		
 </form>	
 <script>form1.service.value="[#service#]";
 	form1.trantype.value="[#prot#]";
 
</script>	
</BODY>
</html>
